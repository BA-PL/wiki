---
title: EL3356
nav_order: 1
layout: page
parent: Moduły IO
---

# Ważenie produktów za pomocą modułu EL3356
{: .no_toc }
<h6> Data modyfikacji: 11.02.2026 </h6>
## Table of Contents
{: .no_toc .text-delta }

1. TOC
{:toc}

# EL3356
EL3356 jest 1-kanałowym modułem analogowym, który pozwala na bezpośrednie podłączenie mostka tensometrycznego za pomocą cztero- lub szescio-przewodowego połączenia.

## Opis wejść

![waga1](https://ba-pl.github.io/wiki/assets/images/EL3356/waga1.png "waga1")

| Pin | Nazwa     | Opis |
|--------------|-----------|------|
| 1 | +UDIFF | Dodatnie napięcie pomiarowe |
| 2 | -UDIFF | Ujemne napięcie pomiarowe |
| 3 | -UV    | Ujemne napięcie zasilania, połączone z power contactami zasilania wewnątrz terminala |
| 4 | Shield | Ekran |
| 5 | +UREF  | Dodatnie napięcie referencyjne |
| 6 | -UREF  | Ujemne napięcie referencyjne |
| 7 | +UV    | Dodatnie napięcie zasilania, połączone z power contactami zasilania wewnątrz terminala |
| 8 | Shield | Ekran |


## Połączenie z przykładowym mostkiem tensometrycznym
W przykładznie wykorzystano mostek tensometryczny GUANG CE YZC-1B. Wykorzystuje on połaczenie 4-przewodowe, gdzie:
- przewód czerwony - napięcie wejściowe dodatnie,
- przewód czarny - napięcie wejściowe ujemne,
- przewód zielony - sygnał wyjściowy dodatni,
- przewód biały - sygnał wyjściowy ujemny.

Do napięcia referencyjnego (UREF) wykorzystano zewnętrzny zasilacz 12V. 

Mostek tensometryczny podłączono do EL3356 zgodnie ze schematem:

| Pin | Nazwa     | Podłączenie |
|--------------|-----------|------|
| 1 | +UDIFF | Przewód zielony |
| 2 | -UDIFF | Przewód biały |
| 3 | -UV    | Przewód czarny |
| 5 | +UREF  | +12 V z zasilacza |
| 6 | -UREF  | 0 V z zasilacza |
| 7 | +UV    | Przewód czerwony |

![waga2](https://ba-pl.github.io/wiki/assets/images/EL3356/waga2.png "waga2")

Przed przystąpieniem do podłączenia mostka tensometrycznego należy dokładnie zapoznać się z dokumentacją producenta czujnika. Kolorystyka żył nie jest standaryzowana i może różnić się w zależności od modelu lub producenta.

## Uruchomienie i kalibracja
Zanim moduł zacznie być wykorzystywany, należy go skalibrować. W tym celu w zakładce Settings należy wybrać najdokładniejszy możliwy filtr (w tym przypadku IIR8) (1), zatwierdzić zmianę (2) oraz rozpocząć kalibrację (3).

![waga3](https://ba-pl.github.io/wiki/assets/images/EL3356/waga3.png "waga3")

Na początku należy podać nominalne (maksymalnie dopuszczalne) obciążenie wykorzystanego mostka tensometrycznego w pożądanej jednostce.

![waga4](https://ba-pl.github.io/wiki/assets/images/EL3356/waga4.png "waga4")

Następnie należy poczekać, aż odczytywany pomiar się ustabilizuje i wytarować wagę naciskając ZERO.

![waga5](https://ba-pl.github.io/wiki/assets/images/EL3356/waga5.png "waga5")

Ostatnim krokiem jest obciążenie mostka tensometrycznego wagą referencyjną - powinna ona wynosić ok. 1/3 maksymalnego dopuszczalnego obciążenia. Po ustabilizowaniu pomiaru zatwierdzamy wartość wagi referencyjnej naciskająć LOAD.

![waga6](https://ba-pl.github.io/wiki/assets/images/EL3356/waga6.png "waga6")

## Dostępne filtry
Moduł EL3356 posiada software'owe filtry, które wyróżniaja się skończoną odpowiedzią impulsową (filtry FIR) oraz nieskończoną (filtry IIR). W praktyce filtry FIR pozwalają szybkie otrzymanie pomiaru, ale jest on zaszumiony. Używając filtrów IIR można otrzymać niezakłócony pomiar, ale trwa on zdecydowanie dłużej. 

Dostępne filtry do wyboru:

- **FIR 50/60Hz** - pełni funkcję filtra wycinającego (notch filter) i determinuje czas konwersji terminala. Im wyższa częstotliwość filtra, tym krótszy czas konwersji. Dostępne są filtry 50 Hz oraz 60 Hz.
Termin "filtr wycinający" oznacza, że filtr posiada zera (wycięcia) w charakterystyce częstotliwościowej dokładnie na częstotliwości filtra oraz jej wielokrotnościach – tzn. tłumi on amplitudę sygnału dla tych częstotliwości. Filtr FIR działa jako filtr nierekurencyjny.
- **PDO** - działa analogicznie do opisanego powyżej filtra FIR 50/60 Hz. Jednak w tym przypadku częstotliwość filtra można regulować z dokładnością do 0,1 Hz za pomocą obiektu danych wyjściowych. Zakres częstotliwości filtra wynosi od 0,1 Hz do 200 Hz, a jego parametry można zmieniać w trakcie pracy urządzenia
- **IIR 1-8** - liniowy, niezmienny w czasie filtr dyskretny, który można ustawić na jeden z ośmiu poziomów (poziom 1 = słaby filtr rekurencyjny, aż do poziomu 8 = silny filtr rekurencyjny).
- **Dynamic IIR** - filtr automatycznie przełącza się pomiędzy ośmioma różnymi filtrami IIR w zależności od zmiany obciążenia (wagi). Stanem docelowym jest zawsze filtr IIR8, który zapewnia największe możliwe tłumienie. W przypadku szybkich zmian wartości wejściowej filtr jest „otwierany”, czyli przełączany na kolejny niższy poziom filtru, o ile jest to jeszcze możliwe. Jeżeli natomiast wartość pomiarowa zmienia się tylko w niewielkim stopniu, filtr jest „zamykany”, czyli przełączany na kolejny wyższy poziom filtru, o ile jest to możliwe. Ocena konieczności obniżenia poziomu filtra lub możliwości jego podwyższenia odbywa się w sposób ciągły, w stałych odstępach czasu.



# TF3685 Weighing Library
## Instalacja
### Dla TwinCAT/BSD
Instalacja odbywa się poprzez command line z poziomu sterownika. Opisane jest to w [Infosys](https://infosys.beckhoff.com/english.php?content=../content/1033/tf6250_tc3_modbus_tcp/11519180811.html&id=)

### Dla pełnych systemów operacyjnych
Procedura instalacji dodatków opisana jest oddzielnie dla wersji [4026](https://ba-pl.github.io/wiki/docs/TwinCAT%203/Instalacja/Instalacja/#instalacja-twincat-i-funkcji) oraz dla wersji [4024](https://ba-pl.github.io/wiki/docs/TwinCAT%203/Instalacja/Instalacja%204024/#instalacja-bibliotek-oraz-dodatkowych-narz%C4%99dzi). Należy postępować zgodnie z instrukcją, instalując dodatek TF3685 Weighing Library.

### Dla Beckhoff RT Linux
Procedura instalacji opisana jest [tutaj](https://ba-pl.github.io/wiki/docs/IPC/Linux/LinuxDodatki/#odszuakanie-nazwy-i-instalacja-dodatku). Należy postępować zgodnie z instrukcją, instalując dodatek TF3685 Weighing Library.


## Wprowadzenie
Biblioteka koncentruje się przede wszystkim na ważeniu dynamicznym, w którym kluczowe znaczenie ma szybki i precyzyjny pomiar. Umożliwia efektywne filtrowanie sygnału, dzięki czemu wynik ważenia można uzyskać w krótkim czasie. Rozwiązanie pozwala na użycie jednego lub kilku ogniw tensometrycznych, zapewnia skalowanie wartości pomiarowych oraz obsługuje funkcje zerowania i tarowania, a także umożliwia realizację pomiarów w trybie ręcznym lub automatycznym.

## Opis procedury pomiarowej

Standardowa procedura pomiarowa składa się z trzech kroków. Na początku sygnał jest filtrowany w celu usunięcia szumów pomiarowych. Wykorzystywany jest do tego blok funkcyjny FB_WG_ComboFilter, który zawiera kombinację trzech filtrów: PTn, Moving Average oraz Notch, połączonych szeregowo. 

Następnie przefiltrowany pomiar jest skalowany do odpowiedniej jednostki (np. gramy) za pomocą bloku funkcyjnego FB_WG_Scaling. Proces ten wymaga wcześniejszej kalibracji, np. metodą dwupunktową. 

Na końcu sygnał jest analizowany za pomocą bloku FB_WG_Weighing, który oblicza średnią wartość masy, odchylenie standardowe oraz wartości minimalne i maksymalne z określonego okna próbek. Dodatkowo możliwa jest walidacja pomiaru według zdefiniowanych kryteriów (próg masy, maksymalne odchylenie, dopuszczalne odchylenie standardowe), co pozwala określić poprawność wyniku. Procedura może również obejmować funkcję automatycznego tarowania.

![waga7](https://ba-pl.github.io/wiki/assets/images/EL3356/waga7.png "waga7")

## Opis bloku FB_WG_ComboFilter

![waga8](https://ba-pl.github.io/wiki/assets/images/EL3356/waga8.png "waga8")

### Wejścia
- *stConfig* - struktura [ST_WG_ComboFilter](https://infosys.beckhoff.com/content/1033/tf3685_tc3_weighing_library/15085188747.html?id=5376558649602571804) do konfiguracji zachowania filtra

### Wyjścia
- *bError* - informuje o wystąpieniu błędu
- *bConfigured* - informuje o pomyślnie zakończonej konfiguracji
- *ipResultMessage* - interface z metodami i właściwościami do obsługi wiadomości, więcej informacji [tutaj](https://infosys.beckhoff.com/content/1033/tc3_eventlogger/5003786635.html?id=1982739904931787201)

<!--
## Opis struktury ST_WG_ComboFilter
- *nOrder*
- *fCutoff*
- *fSamplingRate*
- *nSamplesToFilter*
- *fNotchFreqency*
- *bReset*
-->

## Opis bloku FB_WG_Scaling

![waga9](https://ba-pl.github.io/wiki/assets/images/EL3356/waga9.png "waga9")

### Wejścia
- *stConfig* - struktura [ST_WG_Scaling](https://infosys.beckhoff.com/content/1033/tf3685_tc3_weighing_library/15085221643.html?id=5085134818245626923) do konfiguracji skalowania

### Wyjścia
- *bError* - informuje o wystąpieniu błędu
- *bConfigured* - informuje o pomyślnie zakończonej konfiguracji
- *ipResultMesage* - interface z metodami i właściwościami do obsługi wiadomości, więcej informacji [tutaj](https://infosys.beckhoff.com/content/1033/tc3_eventlogger/5003786635.html?id=1982739904931787201)
- *eCalibrateState* - informuje o obecnym stanie kalibracji lub tarowania, więcej informacji [tutaj](https://infosys.beckhoff.com/content/1033/tf3685_tc3_weighing_library/15107220747.html?id=7662671430670065808)
- *tLastTare* - czas ostatniego wywołania metody Tare() lub UpdateTareOffset()
- *fCurrentTareOffset* - aktualny offset tarowania. Jest aktualizowany automatycznie po wywołaniu metod Tare() lub UpdateTareOffset()

<!--
## Opis struktury ST_WG_Scaling
- *fRawLow*
- *fRawHigh*
- *fReferenceLow*
- *fReferenceHigh*
- -->

## Opis bloku FB_WG_Weighing

![waga10](https://ba-pl.github.io/wiki/assets/images/EL3356/waga10.png "waga10")

### Wejścia
- *stConfig* - struktura [ST_WG_Weighing](https://infosys.beckhoff.com/content/1033/tf3685_tc3_weighing_library/15085318027.html?id=238236500504764595) do konfiguracji

### Wyjścia
- *bError* - informuje o wystąpieniu błędu
- *bConfigured* - informuje o pomyślnie zakończonej konfiguracji
- *ipResultMesage* - interface z metodami i właściwościami do obsługi wiadomości, więcej informacji [tutaj](https://infosys.beckhoff.com/content/1033/tc3_eventlogger/5003786635.html?id=1982739904931787201)

- *bValidMeasurement* - informuje czy wynik jest poprawny
- *bNewResult* - informuje czy nowy wynik został obliczony
- *tLastResult* - czas ostatniego obliczonego wyniku
- *fLastWeight* - waga obliczona jako średnia krocząca ostatnich wyników
- *fLastHour* - odchylenie standardowe ostatniego wyniku
- *fWeight* - obecna waga obliczona jako średnia krocząca
- *fStd* - aktualna wartość kroczącego odchylenia standardowego.
- *fMin* - minimalna wartość wagi w bieżącym oknie próbek
- *fMax* - maksymalna wartość wagi w bieżącym oknie próbek
- *fAutoTareOffset* - ostatni obliczony offset tarowania
- *bNewAutoTareResult* - informuje czy nowa wartość tarowania została obliczona

<!--
## Opis struktury ST_WG_Weighing
- *nWindowLength*
- *Validation*
- *AutoTare*
-->

## Przykład aplikacji
Przykładową aplikację możesz znaleźć tutaj:
<br>
<br>
[link](https://infosys.beckhoff.com/content/1033/tf3685_tc3_weighing_library/16125202699.html){: .btn .btn-red }
